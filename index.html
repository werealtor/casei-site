<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Minimal Toggle Test</title>

<!-- 跟随系统的主题元信息（非必需） -->
<meta name="color-scheme" content="light dark">
<meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
<meta name="theme-color" content="#0b0b0b" media="(prefers-color-scheme: dark)">

<style>
  /* ====== 最小样式，内联，避免路径问题 ====== */
  :root{
    --bg:#ffffff; --text:#111; --line:#eaeaea;
  }
  html[data-theme="dark"]{
    --bg:#0b0b0b; --text:#f5f5f5; --line:#333;
  }
  *{box-sizing:border-box}
  html,body{margin:0;height:100%}
  body{
    display:flex;align-items:center;justify-content:center;
    background:var(--bg); color:var(--text); font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    transition:background .2s,color .2s;
  }
  h1{font-size:20px;font-weight:600;margin:0 12px;text-align:center}

  /* 悬浮按钮（正式样式） */
  .floating-toggle{
    position:fixed; right:20px; bottom:20px;
    width:48px; height:48px; border-radius:50%;
    display:flex; align-items:center; justify-content:center;
    background:var(--bg); color:var(--text);
    border:1px solid var(--line);
    box-shadow:0 6px 18px rgba(0,0,0,.15);
    font-size:22px; cursor:pointer;
    z-index:9999; transition:transform .18s ease;
  }
  .floating-toggle:hover{ transform:scale(1.08) }
</style>
</head>
<body>
  <h1>最小测试页（应显示右下角 🌙/☀️ 按钮）</h1>

  <!-- 悬浮按钮（正式） -->
  <button id="themeToggle" class="floating-toggle" aria-label="Toggle theme" title="切换浅/深色">🌙</button>

<script>
/* ====== 主题切换逻辑（记忆选择） ====== */
(function(){
  const btn = document.getElementById('themeToggle');
  if(!btn) return;

  const saved = localStorage.getItem('theme');
  const setIcon = m => btn.textContent = (m==='dark' ? '☀️' : '🌙');

  if(saved){
    document.documentElement.setAttribute('data-theme', saved);
    setIcon(saved);
  }else if(window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches){
    document.documentElement.setAttribute('data-theme','dark'); setIcon('dark');
  }else{
    setIcon('light');
  }

  btn.addEventListener('click', ()=>{
    const cur = document.documentElement.getAttribute('data-theme') || 'light';
    const next = cur === 'dark' ? 'light' : 'dark';
    document.documentElement.setAttribute('data-theme', next);
    localStorage.setItem('theme', next);
    setIcon(next);
  });
})();

/* ====== DEBUG 强制出现按钮（如果上面按钮没被渲染/被删） ======
   这段会在找不到 #themeToggle 时，注入一个红黄大按钮，确保你一定能“看见东西”。
*/
(function(){
  if(document.getElementById('themeToggle')) return; // 已存在就不插
  const btn = document.createElement('button');
  btn.id = 'themeToggle';
  btn.textContent = '🌙';
  Object.assign(btn.style, {
    position:'fixed',right:'20px',bottom:'20px',width:'80px',height:'80px',
    borderRadius:'12px',background:'red',color:'#fff',fontSize:'36px',
    fontWeight:'700',border:'4px solid yellow',boxShadow:'0 10px 30px rgba(0,0,0,.25)',
    zIndex:'2147483647',cursor:'pointer'
  });
  document.body.appendChild(btn);
})();
</script>

<!-- BUILD MARK: 2025-09-22-minimal-test -->
</body>
</html>